import httplib2
import json

example1 = '{"organizations": [{"title": "Chief Executive Officer", "current": false, "name": "Thrive Internet Marketing", "isPrimary": false}], "contactInfo": {"websites": [{"url": "http://www.swankmartini.com"}, {"url": "http://www.thriveim.com"}, {"url": "http://www.thriveim.com/portfolio"}], "familyName": "Hartten", "fullName": "Ian Hartten", "givenName": "Ian"}, "likelihood": 0.95, "requestId": "8b16b109-38b9-4ce1-b5d1-1c43fad04c99", "digitalFootprint": {"scores": [{"provider": "klout", "value": 39, "type": "general"}], "topics": [{"provider": "aboutme", "value": "Ecommerce"}, {"provider": "aboutme", "value": "Ski"}, {"provider": "aboutme", "value": "Tennis"}, {"provider": "aboutme", "value": "Toledo Ohio"}, {"provider": "klout", "value": "Facebook"}, {"provider": "klout", "value": "Marketing"}, {"provider": "klout", "value": "SEO"}, {"provider": "klout", "value": "Startups"}]}, "demographics": {"locationDeduced": {"continent": {"name": "North America", "deduced": true}, "normalizedLocation": "Toledo, Ohio, United States", "county": {"name": "Lucas", "deduced": true}, "state": {"code": "OH", "name": "Ohio", "deduced": false}, "country": {"code": "US", "name": "United States", "deduced": false}, "likelihood": 1.0, "city": {"name": "Toledo", "deduced": false}, "deducedLocation": "Toledo, Ohio, United States"}, "gender": "Male", "locationGeneral": "Toledo, Ohio, United States"}, "photos": [{"type": "linkedin", "typeId": "linkedin", "url": "https://d2ojpxxtu63wzl.cloudfront.net/static/ebe3c45758d3ff6d353be52b49b8fe51_fa3ac79914c8027e7d107980fc9838bfa42b8a7a9e6f241f331d856a1fdf01a9", "typeName": "LinkedIn", "isPrimary": true}, {"type": "facebook", "typeId": "facebook", "url": "https://d2ojpxxtu63wzl.cloudfront.net/static/97cf7a2bdcbb7f860db857c8279b0aa6_d6847a24581fe00a816c9dffd09599f428f64b7d8bb222ca22e2f3edaef7f5c8", "typeName": "Facebook", "isPrimary": false}, {"type": "foursquare", "typeId": "foursquare", "url": "https://d2ojpxxtu63wzl.cloudfront.net/static/5ed7f4b2fe9b6ea3d6f7d82485e65c0b_862634f7c7fad63b295bb9e0483b9c601aa74f2671c34ad3b8799404b24bdc7b", "typeName": "Foursquare", "isPrimary": false}, {"type": "pinterest", "typeId": "pinterest", "url": "https://d2ojpxxtu63wzl.cloudfront.net/static/5deaf0142ac5973c322b50401187f799_08390374654f8b5c2b0fa8df5e340693dd4d292835869e9f2fbddad94c11e2cc", "typeName": "Pinterest", "isPrimary": false}, {"type": "google", "typeId": "google", "url": "https://d2ojpxxtu63wzl.cloudfront.net/static/6ef278e3beb112178be9c3952b2ae587_ac25ebb0173793592480e3a998b7981fc23328061bdaddbd63eeadf56645b3d6", "typeName": "GooglePlus", "isPrimary": false}], "socialProfiles": [{"type": "aboutme", "username": "ianhartten", "url": "https://about.me/ianhartten", "typeName": "About.me", "typeId": "aboutme", "bio": "<p>Welcome..... Please contact me anytime via this page so we can stay in touch. My passion is Digital Internet Marketing. I love to help people like you take advantage of this amazing digital revolution. I have 21 years of online experience, have built over 150 ecommerce sites, 600 websites and own 5 of my own.<br />I WANT TO HELP YOU MARKET &amp; SELL MORE ONLINE.</p>"}, {"type": "facebook", "typeId": "facebook", "url": "https://www.facebook.com/ian.hartten", "typeName": "Facebook"}, {"type": "flickr", "username": "ianhartten", "url": "https://www.flickr.com/people/92266445@N00", "typeName": "Flickr", "typeId": "flickr", "id": "92266445@N00"}, {"type": "foursquare", "typeId": "foursquare", "url": "https://foursquare.com/user/34505012", "typeName": "Foursquare", "id": "34505012"}, {"followers": 93, "type": "google", "username": "IanHartten", "url": "https://plus.google.com/106854082872873737984", "typeName": "GooglePlus", "typeId": "google", "id": "106854082872873737984"}, {"type": "instagram", "typeId": "instagram", "url": "https://instagram.com/ihartten", "typeName": "Instagram"}, {"type": "klout", "username": "ianhartten", "url": "http://klout.com/ianhartten", "typeName": "Klout", "typeId": "klout", "id": "32369627086868885"}, {"followers": 500, "following": 500, "username": "ianhartten", "url": "https://www.linkedin.com/in/ianhartten", "typeName": "LinkedIn", "type": "linkedin", "typeId": "linkedin", "id": "436593"}, {"followers": 165, "following": 157, "username": "ianhartten", "url": "http://www.pinterest.com/ianhartten/", "typeName": "Pinterest", "type": "pinterest", "typeId": "pinterest", "bio": "Living in Toledo, loving the lake, playing lots of tennis."}, {"followers": 30, "following": 2, "username": "Tweet2EatDeals", "url": "https://twitter.com/Tweet2EatDeals", "typeName": "Twitter", "type": "twitter", "typeId": "twitter", "id": "352517172"}, {"type": "vimeo", "username": "user6071181", "url": "http://vimeo.com/user6071181", "typeName": "Vimeo", "typeId": "vimeo", "id": "6071181"}], "status": 200}'

URL = "https://api.fullcontact.com/v2/person.json"

def http_get_no_cache(uri, xheaders):
    h = httplib2.Http(".cache")
    xheaders['cache-control'] = 'no-cache'
    headers, body = h.request(uri, headers=xheaders)
    status = int(headers["status"])
    if status < 200 or 299 < status and status not in [404, 422]:
        raise RuntimeError("HTTP {}: {} {}".format(status, headers, body))
    else:
        return (status, headers, body)

def http_get_offline(uri, headers):
    return (200, [], bytes(example1, "utf-8"))

def whois(email, headers):
    """Takes an EMAIL and HTTP HEADERS, producing the answer."""
    url = URL + "?email={}".format(email)
    status, headers, body = http_get_no_cache(url, headers)
    return (json.loads(body.decode("utf-8")), headers, status)
